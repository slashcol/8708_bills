function _classCallCheck(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,e){for(var t=0;t<e.length;t++){var i=e[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}}function _createClass(n,e,t){return e&&_defineProperties(n.prototype,e),t&&_defineProperties(n,t),n}function _inherits(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),e&&_setPrototypeOf(n,e)}function _setPrototypeOf(n,e){return(_setPrototypeOf=Object.setPrototypeOf||function(n,e){return n.__proto__=e,n})(n,e)}function _createSuper(n){var e=_isNativeReflectConstruct();return function(){var t,i=_getPrototypeOf(n);if(e){var o=_getPrototypeOf(this).constructor;t=Reflect.construct(i,arguments,o)}else t=i.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(n,e){return!e||"object"!=typeof e&&"function"!=typeof e?_assertThisInitialized(n):e}function _assertThisInitialized(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(n){return!1}}function _getPrototypeOf(n){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)})(n)}(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{GvuD:function(n,e,t){"use strict";t.d(e,"a",(function(){return Q}));var i=t("mrSG"),o=t("3Pt+"),r=t("NV1z"),s=t("jgsO"),a=t("GGTb"),c=t("fXoL"),u=t("TEn/"),l=t("ofXK"),b=t("sYmb");function g(n,e){1&n&&c.Qb(0,"ion-spinner",5)}function h(n,e){1&n&&(c.Vb(0,"span"),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Gc(c.ic(2,1,"SUBMIT")))}var p,f=((p=function(n){_inherits(t,n);var e=_createSuper(t);function t(n,i){var r;return _classCallCheck(this,t),(r=e.call(this,n)).userService=i,r.form=new o.c({email:new o.a("",[o.m.required,o.m.email])}),r}return _createClass(t,[{key:"enableMenuSwipe",value:function(){return!1}},{key:"onDismiss",value:function(){this.modalCtrl.dismiss()}},{key:"onSubmit",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e,t,i=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.form.invalid){n.next=5;break}return n.next=3,this.getTrans("INVALID_FORM");case 3:return e=n.sent,n.abrupt("return",this.showToast(e));case 5:return n.prev=5,n.next=8,this.showLoadingView({showOverlay:!1});case 8:return t=this.form.value.email,n.next=11,this.userService.recoverPassword(t);case 11:this.showContentView(),this.translate.get("FORGOT_PASSWORD_SUCCESS").subscribe((function(n){return i.showAlert(n)})),n.next=18;break;case 15:n.prev=15,n.t0=n.catch(5),205===n.t0.code?this.translate.get("EMAIL_NOT_FOUND").subscribe((function(n){return i.showToast(n)})):this.translate.get("ERROR_NETWORK").subscribe((function(n){return i.showToast(n)})),this.showContentView();case 18:case"end":return n.stop()}}),n,this,[[5,15]])})))}}]),t}(r.a)).\u0275fac=function(n){return new(n||p)(c.Pb(c.r),c.Pb(s.a))},p.\u0275cmp=c.Jb({type:p,selectors:[["page-forgot-password"]],features:[c.zb],decls:27,vars:13,consts:[[1,"ion-no-border"],["slot","end"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding"],["color","dark"],["novalidate","",3,"formGroup","ngSubmit"],["forgotPasswordForm","ngForm"],["position","stacked","color","medium"],[1,"bold"],["lines","none","color","light",1,"ion-margin-vertical"],["type","email","formControlName","email",3,"keyup.enter"],[1,"ion-justify-content-center"],["size-xs","6","size-md","4",1,"ion-text-center"],["type","submit","shape","round","expand","block","color","light",3,"disabled"],["color","dark",4,"ngIf"],[4,"ngIf"]],template:function(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-header",0),c.Vb(1,"ion-toolbar"),c.Vb(2,"ion-title"),c.Fc(3),c.hc(4,"translate"),c.Ub(),c.Vb(5,"ion-buttons",1),c.Vb(6,"ion-button",2),c.dc("click",(function(){return e.onDismiss()})),c.Qb(7,"ion-icon",3),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(8,"ion-content",4),c.Vb(9,"ion-text",5),c.Vb(10,"p"),c.Fc(11),c.hc(12,"translate"),c.Ub(),c.Qb(13,"p"),c.Ub(),c.Vb(14,"form",6,7),c.dc("ngSubmit",(function(){return e.onSubmit()})),c.Vb(16,"ion-label",8),c.Vb(17,"span",9),c.Fc(18),c.hc(19,"translate"),c.Ub(),c.Ub(),c.Vb(20,"ion-item",10),c.Vb(21,"ion-input",11),c.dc("keyup.enter",(function(){return c.wc(t),c.uc(15).ngSubmit.emit()})),c.Ub(),c.Ub(),c.Vb(22,"ion-row",12),c.Vb(23,"ion-col",13),c.Vb(24,"ion-button",14),c.Dc(25,g,1,0,"ion-spinner",15),c.Dc(26,h,3,3,"span",16),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()}2&n&&(c.Cb(3),c.Gc(c.ic(4,7,"FORGOT_PASSWORD")),c.Cb(8),c.Gc(c.ic(12,9,"FORGOT_PASSWORD_HELP")),c.Cb(3),c.mc("formGroup",e.form),c.Cb(4),c.Gc(c.ic(19,11,"EMAIL")),c.Cb(6),c.mc("disabled",e.isLoadingViewVisible),c.Cb(1),c.mc("ngIf",e.isLoadingViewVisible),c.Cb(1),c.mc("ngIf",!e.isLoadingViewVisible))},directives:[u.s,u.Y,u.W,u.k,u.j,u.t,u.p,u.T,o.n,o.j,o.d,u.z,u.x,u.w,u.ib,o.i,o.b,u.J,u.o,l.l,u.P],pipes:[b.c],styles:["ion-content[_ngcontent-%COMP%]{--padding-top:40px}ion-item[_ngcontent-%COMP%]{--border-radius:4px}"]}),p),d=t("ahC7"),m=t("up+p"),v=t("3EM6"),w=t("xS7M"),V=t("AytR"),k=t("gNTI");function S(n,e){if(1&n){var t=c.Wb();c.Vb(0,"div",7),c.Vb(1,"div",8),c.Vb(2,"h3"),c.Fc(3),c.hc(4,"translate"),c.Ub(),c.Qb(5,"p",9),c.hc(6,"translate"),c.Vb(7,"ion-row"),c.Vb(8,"ion-col"),c.Vb(9,"ion-button",10),c.dc("click",(function(){return c.wc(t),c.gc().onLoginButtonTouched()})),c.Fc(10),c.hc(11,"translate"),c.Ub(),c.Ub(),c.Vb(12,"ion-col"),c.Vb(13,"ion-button",11),c.dc("click",(function(){return c.wc(t),c.gc().onSignUpButtonTouched()})),c.Fc(14),c.hc(15,"translate"),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()}2&n&&(c.Cb(3),c.Gc(c.ic(4,4,"LOGIN")),c.Cb(2),c.mc("innerHTML",c.ic(6,6,"LOGIN_INFO"),c.xc),c.Cb(5),c.Hc(" ",c.ic(11,8,"LOGIN")," "),c.Cb(4),c.Hc(" ",c.ic(15,10,"SIGN_UP")," "))}function I(n,e){1&n&&c.Qb(0,"ion-spinner",28)}function C(n,e){1&n&&(c.Vb(0,"span"),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Gc(c.ic(2,1,"LOGIN")))}function U(n,e){1&n&&(c.Vb(0,"div",29),c.Qb(1,"ion-spinner"),c.Ub())}function y(n,e){1&n&&c.Qb(0,"ion-spinner",28)}function _(n,e){1&n&&(c.Vb(0,"span",34),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Hc(" ",c.ic(2,1,"FACEBOOK")," "))}function O(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-col",30),c.Vb(1,"ion-button",31),c.dc("click",(function(){return c.wc(t),c.gc(2).onFacebookButtonTouched()})),c.Qb(2,"ion-icon",32),c.Dc(3,y,1,0,"ion-spinner",21),c.Dc(4,_,3,3,"span",33),c.Ub(),c.Ub()}if(2&n){var i=c.gc(2);c.Cb(1),c.mc("disabled",i.isSignInViaApple||i.isSignInViaGoogle||i.isSignInViaUsername||i.isSignInViaFacebook),c.Cb(2),c.mc("ngIf",i.isSignInViaFacebook),c.Cb(1),c.mc("ngIf",!i.isSignInViaFacebook)}}function F(n,e){1&n&&c.Qb(0,"ion-spinner",28)}function x(n,e){1&n&&(c.Vb(0,"span",34),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Hc(" ",c.ic(2,1,"GOOGLE_LOGIN")," "))}function L(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-col",30),c.Vb(1,"ion-button",35),c.dc("click",(function(){return c.wc(t),c.gc(2).onGoogleButtonTouched()})),c.Qb(2,"ion-icon",36),c.Dc(3,F,1,0,"ion-spinner",21),c.Dc(4,x,3,3,"span",33),c.Ub(),c.Ub()}if(2&n){var i=c.gc(2);c.Cb(1),c.mc("disabled",i.isSignInViaApple||i.isSignInViaGoogle||i.isSignInViaUsername||i.isSignInViaFacebook),c.Cb(2),c.mc("ngIf",i.isSignInViaGoogle),c.Cb(1),c.mc("ngIf",!i.isSignInViaGoogle)}}function R(n,e){1&n&&c.Qb(0,"ion-spinner",28)}function E(n,e){1&n&&(c.Vb(0,"span",34),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Hc(" ",c.ic(2,1,"APPLE_LOGIN")," "))}function T(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-button",38),c.dc("click",(function(){return c.wc(t),c.gc(3).onAppleButtonTouched()})),c.Qb(1,"ion-icon",39),c.Dc(2,R,1,0,"ion-spinner",21),c.Dc(3,E,3,3,"span",33),c.Ub()}if(2&n){var i=c.gc(3);c.mc("disabled",i.isSignInViaApple||i.isSignInViaGoogle||i.isSignInViaUsername||i.isSignInViaFacebook),c.Cb(2),c.mc("ngIf",i.isSignInViaApple),c.Cb(1),c.mc("ngIf",!i.isSignInViaApple)}}function A(n,e){if(1&n&&(c.Vb(0,"ion-col",30),c.Dc(1,T,4,3,"ion-button",37),c.Ub()),2&n){var t=c.gc(2);c.Cb(1),c.mc("ngIf",t.isAppleSignInAvailable)}}function D(n,e){if(1&n){var t=c.Wb();c.Vb(0,"div"),c.Vb(1,"div",8),c.Qb(2,"img",12),c.Ub(),c.Vb(3,"form",13,14),c.dc("ngSubmit",(function(){return c.wc(t),c.gc().onLogin()})),c.Vb(5,"ion-item",15),c.Qb(6,"ion-input",16),c.hc(7,"translate"),c.Ub(),c.Vb(8,"ion-item",15),c.Vb(9,"ion-input",17),c.dc("keyup.enter",(function(){return c.wc(t),c.uc(4).ngSubmit.emit()})),c.hc(10,"translate"),c.Ub(),c.Ub(),c.Vb(11,"ion-row",18),c.Vb(12,"ion-col",19),c.Vb(13,"ion-button",20),c.Dc(14,I,1,0,"ion-spinner",21),c.Dc(15,C,3,3,"span",6),c.Ub(),c.Ub(),c.Ub(),c.Dc(16,U,2,0,"div",22),c.Vb(17,"ion-row",23),c.Dc(18,O,5,3,"ion-col",24),c.Dc(19,L,5,3,"ion-col",24),c.Dc(20,A,2,1,"ion-col",24),c.Ub(),c.Ub(),c.Vb(21,"ion-row"),c.Vb(22,"ion-col",25),c.Vb(23,"ion-button",26),c.dc("click",(function(){return c.wc(t),c.gc().onForgotPasswordButtonTouched()})),c.Fc(24),c.hc(25,"translate"),c.Ub(),c.Ub(),c.Vb(26,"ion-col",27),c.Vb(27,"ion-button",26),c.dc("click",(function(){return c.wc(t),c.gc().onSignUpButtonTouched()})),c.Fc(28),c.hc(29,"translate"),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&n){var i=c.gc();c.Cb(3),c.mc("formGroup",i.form),c.Cb(3),c.mc("placeholder",c.ic(7,12,"USERNAME_OR_EMAIL")),c.Cb(3),c.mc("placeholder",c.ic(10,14,"PASSWORD")),c.Cb(4),c.mc("disabled",i.isSignInViaApple||i.isSignInViaGoogle||i.isSignInViaUsername||i.isSignInViaFacebook),c.Cb(1),c.mc("ngIf",i.isSignInViaUsername),c.Cb(1),c.mc("ngIf",!i.isSignInViaUsername),c.Cb(1),c.mc("ngIf",i.isLoadingConfig),c.Cb(2),c.mc("ngIf",i.isFacebookLoginEnabled),c.Cb(1),c.mc("ngIf",i.isGoogleLoginEnabled),c.Cb(1),c.mc("ngIf",i.isAppleLoginEnabled),c.Cb(4),c.Hc(" ",c.ic(25,16,"FORGOT_PASSWORD")," "),c.Cb(4),c.Hc(" ",c.ic(29,18,"NO_ACCOUNT_YET_CREATE_ONE")," ")}}function G(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-button",48),c.dc("click",(function(){c.wc(t);var n=c.gc(2);return n.showPass=!n.showPass})),c.Qb(1,"ion-icon",49),c.Ub()}}function N(n,e){if(1&n){var t=c.Wb();c.Vb(0,"ion-button",48),c.dc("click",(function(){c.wc(t);var n=c.gc(2);return n.showPass=!n.showPass})),c.Qb(1,"ion-icon",50),c.Ub()}}function P(n,e){1&n&&c.Qb(0,"ion-spinner",28)}function j(n,e){1&n&&(c.Vb(0,"span"),c.Fc(1),c.hc(2,"translate"),c.Ub()),2&n&&(c.Cb(1),c.Gc(c.ic(2,1,"SIGN_UP")))}function W(n,e){if(1&n){var t=c.Wb();c.Vb(0,"div"),c.Vb(1,"div",8),c.Qb(2,"img",12),c.Ub(),c.Vb(3,"form",13,40),c.dc("ngSubmit",(function(){return c.wc(t),c.gc().onSignUp()})),c.Vb(5,"ion-item",15),c.Qb(6,"ion-input",41),c.hc(7,"translate"),c.Ub(),c.Vb(8,"ion-item",15),c.Qb(9,"ion-input",16),c.hc(10,"translate"),c.Ub(),c.Vb(11,"ion-item",15),c.Qb(12,"ion-input",42),c.hc(13,"translate"),c.Ub(),c.Vb(14,"ion-text",43),c.Vb(15,"p"),c.Vb(16,"small"),c.Fc(17),c.hc(18,"translate"),c.Ub(),c.Ub(),c.Ub(),c.Vb(19,"ion-item",15),c.Vb(20,"ion-input",44),c.dc("keyup.enter",(function(){return c.wc(t),c.uc(4).ngSubmit.emit()})),c.hc(21,"translate"),c.Ub(),c.Dc(22,G,2,0,"ion-button",45),c.Dc(23,N,2,0,"ion-button",45),c.Ub(),c.Vb(24,"ion-text",43),c.Vb(25,"p"),c.Vb(26,"small"),c.Fc(27),c.hc(28,"translate"),c.Ub(),c.Ub(),c.Ub(),c.Vb(29,"ion-row",23),c.Vb(30,"ion-col",19),c.Vb(31,"ion-button",20),c.Dc(32,P,1,0,"ion-spinner",21),c.Dc(33,j,3,3,"span",6),c.Ub(),c.Ub(),c.Ub(),c.Vb(34,"ion-row",23),c.Vb(35,"ion-col",46),c.Vb(36,"ion-button",47),c.dc("click",(function(){return c.wc(t),c.gc().onLoginButtonTouched()})),c.Fc(37),c.hc(38,"translate"),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Ub()}if(2&n){var i=c.gc();c.Cb(3),c.mc("formGroup",i.form),c.Cb(3),c.mc("placeholder",c.ic(7,14,"NAME")),c.Cb(3),c.mc("placeholder",c.ic(10,16,"USERNAME")),c.Cb(3),c.mc("placeholder",c.ic(13,18,"EMAIL")),c.Cb(5),c.Gc(c.ic(18,20,"EMAIL_FIELD_HELP")),c.Cb(3),c.mc("type",i.showPass?"text":"password")("placeholder",c.ic(21,22,"PASSWORD")),c.Cb(2),c.mc("ngIf",!i.showPass),c.Cb(1),c.mc("ngIf",i.showPass),c.Cb(4),c.Gc(c.ic(28,24,"PASSWORD_VALIDATION_MSG")),c.Cb(4),c.mc("disabled",i.isSignUpLoading),c.Cb(1),c.mc("ngIf",i.isSignUpLoading),c.Cb(1),c.mc("ngIf",!i.isSignUpLoading),c.Cb(4),c.Hc(" ",c.ic(38,26,"BACK_TO_LOGIN")," ")}}var M,Q=((M=function(n){_inherits(t,n);var e=_createSuper(t);function t(n,i,o,r,s,a,c,u){var l;return _classCallCheck(this,t),(l=e.call(this,n)).fb=i,l.authService=o,l.googlePlus=r,l.signInWithApple=s,l.device=a,l.appConfigService=c,l.userService=u,l.isSignInViaFacebook=!1,l.isSignInViaGoogle=!1,l.isSignInViaApple=!1,l.isSignInViaUsername=!1,l.isAppleSignInAvailable=!1,l.isSignUpLoading=!1,l}return _createClass(t,[{key:"ngOnInit",value:function(){var n=this,e=parseInt(this.device.version);this.isAppleSignInAvailable=e>=13&&this.isCordova()&&this.isIos(),this.showLoginForm?this.setupLoginForm():this.showSignUpForm&&this.setupSignUpForm(),this.googleSubscription=this.authService.authState.subscribe((function(e){e&&n.loggedIntoGoogle(e)})),this.loadAppConfig()}},{key:"ngOnDestroy",value:function(){this.googleSubscription.unsubscribe()}},{key:"enableMenuSwipe",value:function(){return!1}},{key:"onDismiss",value:function(){this.modalCtrl.dismiss()}},{key:"loadAppConfig",value:function(){var n,e,t;return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,this.isLoadingConfig=!0,i.next=4,this.appConfigService.load();case 4:o=i.sent,this.isFacebookLoginEnabled=null===(n=null==o?void 0:o.auth)||void 0===n?void 0:n.isFacebookLoginEnabled,this.isGoogleLoginEnabled=null===(e=null==o?void 0:o.auth)||void 0===e?void 0:e.isGoogleLoginEnabled,this.isAppleLoginEnabled=null===(t=null==o?void 0:o.auth)||void 0===t?void 0:t.isAppleLoginEnabled,this.isLoadingConfig=!1,i.next=11;break;case 8:i.prev=8,i.t0=i.catch(0),this.isLoadingConfig=!1;case 11:case"end":return i.stop()}}),i,this,[[0,8]])})))}},{key:"onLoginButtonTouched",value:function(){this.showLoginForm=!0,this.showSignUpForm=!1,this.setupLoginForm()}},{key:"onSignUpButtonTouched",value:function(){this.showLoginForm=!1,this.showSignUpForm=!0,this.setupSignUpForm()}},{key:"setupLoginForm",value:function(){this.form=new o.c({username:new o.a("",o.m.required),password:new o.a("",o.m.required)})}},{key:"setupSignUpForm",value:function(){this.form=new o.c({name:new o.a("",o.m.required),username:new o.a("",o.m.required),email:new o.a(""),password:new o.a("",[o.m.required,o.m.minLength(6)])})}},{key:"onFacebookButtonTouched",value:function(){var n=this;this.isHybrid()?this.fb.login(["public_profile"]).then((function(e){return n.loggedIntoFacebook(e)})).catch((function(n){return console.log("Error logging into Facebook",n)})):this.userService.loginViaFacebook().then((function(e){return n.loggedViaFacebook(e)})).catch((function(n){return console.log("Error logging into Facebook",n)}))}},{key:"loggedIntoFacebook",value:function(n){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new Date).setSeconds(t.getSeconds()+n.authResponse.expiresIn),i=t.toISOString(),o={id:n.authResponse.userID,access_token:n.authResponse.accessToken,expiration_date:i},e.prev=3,e.next=6,this.showLoadingView({showOverlay:!1});case 6:return this.isSignInViaFacebook=!0,e.next=9,this.userService.loginWith("facebook",{authData:o});case 9:r=e.sent,this.loggedViaFacebook(r),this.isSignInViaFacebook=!1,e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),this.loginViaFacebookFailure(e.t0),this.isSignInViaFacebook=!1;case 16:case"end":return e.stop()}}),e,this,[[3,13]])})))}},{key:"loginViaFacebookFailure",value:function(n){var e=this;console.log("Error logging into Facebook",n),this.translate.get("ERROR_NETWORK").subscribe((function(n){return e.showToast(n)})),this.showContentView()}},{key:"loggedViaFacebook",value:function(n){var e=this;this.showContentView(),this.translate.get("LOGGED_IN_AS",{name:n.attributes.name}).subscribe((function(n){return e.showToast(n)})),window.dispatchEvent(new CustomEvent("user:login",{detail:n})),this.onDismiss()}},{key:"onGoogleButtonTouched",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!this.isHybrid()){n.next=13;break}return n.prev=1,n.next=4,this.googlePlus.login({webClientId:V.a.googleClientId});case 4:e=n.sent,this.loggedIntoGoogle({id:e.userId,authToken:e.accessToken,idToken:e.idToken}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(1),console.error(n.t0);case 11:n.next=14;break;case 13:this.authService.signIn(d.a.PROVIDER_ID);case 14:case"end":return n.stop()}}),n,this,[[1,8]])})))}},{key:"loggedIntoGoogle",value:function(n){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,i,o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Logged into Google",n),e.prev=1,this.isSignInViaGoogle=!0,t={id:n.id,access_token:n.authToken,id_token:n.idToken},e.next=6,this.userService.loginWith("google",{authData:t});case 6:i=e.sent,this.isSignInViaGoogle=!1,this.translate.get("LOGGED_IN_AS",{name:i.name}).subscribe((function(n){return o.showToast(n)})),this.onDismiss(),window.dispatchEvent(new CustomEvent("user:login",{detail:i})),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),console.log("Error logging into Google",e.t0),this.isSignInViaGoogle=!1,this.translate.get("ERROR_NETWORK").subscribe((function(n){return o.showToast(n)})),this.showContentView();case 13:case"end":return e.stop()}}),e,this,[[1,10]])})))}},{key:"onAppleButtonTouched",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e,t,i,o,r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.isSignInViaApple=!0,n.next=4,this.signInWithApple.signin({requestedScopes:[v.a.ASAuthorizationScopeFullName,v.a.ASAuthorizationScopeEmail]});case 4:return e=n.sent,t={id:e.user,token:e.identityToken},i={},e.fullName.givenName&&e.fullName.familyName&&(i.name=e.fullName.givenName+" "+e.fullName.familyName),n.next=10,this.userService.loginWith("apple",{authData:t},i);case 10:o=n.sent,this.isSignInViaApple=!1,this.translate.get("LOGGED_IN_AS",{name:o.name}).subscribe((function(n){return r.showToast(n)})),this.onDismiss(),window.dispatchEvent(new CustomEvent("user:login",{detail:o})),n.next=17;break;case 14:n.prev=14,n.t0=n.catch(0),this.isSignInViaApple=!1;case 17:case"end":return n.stop()}}),n,this,[[0,14]])})))}},{key:"onLogin",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e,t,i,o=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!this.form.invalid){n.next=6;break}return n.next=4,this.getTrans("INVALID_FORM");case 4:return e=n.sent,n.abrupt("return",this.showToast(e));case 6:return n.next=8,this.showLoadingView({showOverlay:!1});case 8:return this.isSignInViaUsername=!0,(t=Object.assign({},this.form.value)).username=t.username.trim(),t.password=t.password.trim(),n.next=13,this.userService.signIn(t);case 13:i=n.sent,this.showContentView(),this.isSignInViaUsername=!1,this.translate.get("LOGGED_IN_AS",{name:i.name}).subscribe((function(n){return o.showToast(n)})),this.onDismiss(),window.dispatchEvent(new CustomEvent("user:login",{detail:i})),n.next=20;break;case 17:n.prev=17,n.t0=n.catch(0),101===n.t0.code?this.translate.get("INVALID_CREDENTIALS").subscribe((function(n){return o.showToast(n)})):this.translate.get("ERROR_NETWORK").subscribe((function(n){return o.showToast(n)})),this.showContentView(),this.isSignInViaUsername=!1;case 20:case"end":return n.stop()}}),n,this,[[0,17]])})))}},{key:"onSignUp",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e,t,i,o,r=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,!this.form.invalid){n.next=6;break}return n.next=4,this.getTrans("INVALID_FORM");case 4:return e=n.sent,n.abrupt("return",this.showToast(e));case 6:return(t=Object.assign({},this.form.value)).name=t.name.trim(),t.username=t.username.trim(),t.email=t.email.trim(),t.password=t.password.trim(),""===t.email&&delete t.email,n.next=14,this.showLoadingView({showOverlay:!1});case 14:if(this.isSignUpLoading=!0,i=null,!(o=s.a.getCurrent())||!o.attributes.authData||void 0===o.attributes.authData.anonymous){n.next=27;break}return o.setUsername(t.username),o.setPassword(t.password),delete t.username,delete t.password,n.next=24,o.signUp(t);case 24:i=n.sent,n.next=28;break;case 27:(i=new s.a).signUp(t);case 28:this.showContentView(),this.isSignUpLoading=!1,this.translate.get("LOGGED_IN_AS",{name:i.name}).subscribe((function(n){return r.showToast(n)})),this.onDismiss(),window.dispatchEvent(new CustomEvent("user:login",{detail:i})),n.next=38;break;case 35:n.prev=35,n.t0=n.catch(0),this.showContentView(),this.isSignUpLoading=!1,202===n.t0.code?this.translate.get("USERNAME_TAKEN").subscribe((function(n){return r.showToast(n)})):203===n.t0.code?this.translate.get("EMAIL_TAKEN").subscribe((function(n){return r.showToast(n)})):125===n.t0.code?this.translate.get("EMAIL_INVALID").subscribe((function(n){return r.showToast(n)})):this.translate.get("ERROR_NETWORK").subscribe((function(n){return r.showToast(n)}));case 38:case"end":return n.stop()}}),n,this,[[0,35]])})))}},{key:"onForgotPasswordButtonTouched",value:function(){return Object(i.a)(this,void 0,void 0,regeneratorRuntime.mark((function n(){var e;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.showLoadingView({showOverlay:!0});case 2:return n.next=4,this.modalCtrl.create({component:f});case 4:return e=n.sent,n.next=7,e.present();case 7:this.showContentView();case 8:case"end":return n.stop()}}),n,this)})))}}]),t}(r.a)).\u0275fac=function(n){return new(n||M)(c.Pb(c.r),c.Pb(a.a),c.Pb(d.b),c.Pb(m.a),c.Pb(v.b),c.Pb(w.a),c.Pb(k.a),c.Pb(s.a))},M.\u0275cmp=c.Jb({type:M,selectors:[["page-sign-in"]],inputs:{showLoginForm:"showLoginForm",showSignUpForm:"showSignUpForm"},features:[c.zb],decls:10,vars:3,consts:[[1,"ion-no-border"],["slot","end"],[3,"click"],["slot","icon-only","name","close"],[1,"ion-padding"],["class","center",4,"ngIf"],[4,"ngIf"],[1,"center"],[1,"ion-text-center"],[3,"innerHTML"],["color","primary","expand","block","fill","outline",3,"click"],["color","primary","expand","block",3,"click"],["width","60","src","./assets/imgs/icon.png"],["novalidate","",1,"ion-padding",3,"formGroup","ngSubmit"],["loginForm","ngForm"],["color","light","lines","none",1,"ion-margin-bottom"],["type","text","formControlName","username",3,"placeholder"],["type","password","formControlName","password",3,"placeholder","keyup.enter"],[1,"ion-margin-top","ion-justify-content-center"],["size-xs","8","size-md","6",1,"ion-text-center"],["strong","","type","submit","color","primary","expand","block","shape","round",1,"ion-margin-vertical",3,"disabled"],["color","light",4,"ngIf"],["class","ion-text-center ion-margin-vertical",4,"ngIf"],[1,"ion-justify-content-center"],["size-xs","12","size-md","6",4,"ngIf"],["size","6",1,"ion-text-start"],["strong","","fill","clear",3,"click"],["size","6",1,"ion-text-end"],["color","light"],[1,"ion-text-center","ion-margin-vertical"],["size-xs","12","size-md","6"],["strong","","type","button","color","fb","expand","block","shape","round",3,"disabled","click"],["slot","start","name","logo-facebook","color","light"],["class","ion-text-capitalize",4,"ngIf"],[1,"ion-text-capitalize"],["strong","","type","button","color","google","expand","block","shape","round",3,"disabled","click"],["slot","start","name","logo-google","color","light"],["strong","","type","button","color","dark","expand","block","shape","round",3,"disabled","click",4,"ngIf"],["strong","","type","button","color","dark","expand","block","shape","round",3,"disabled","click"],["slot","start","name","logo-apple","color","light"],["signupForm","ngForm"],["type","text","formControlName","name",3,"placeholder"],["type","email","formControlName","email",3,"placeholder"],["color","dark"],["formControlName","password",3,"type","placeholder","keyup.enter"],["fill","clear","color","dark","type","button","slot","end",3,"click",4,"ngIf"],["size","8",1,"ion-text-center"],["strong","","type","button","fill","clear","expand","block","color","dark",1,"ion-text-capitalize",3,"click"],["fill","clear","color","dark","type","button","slot","end",3,"click"],["name","eye-off"],["name","eye"]],template:function(n,e){1&n&&(c.Vb(0,"ion-header",0),c.Vb(1,"ion-toolbar"),c.Qb(2,"ion-title"),c.Vb(3,"ion-buttons",1),c.Vb(4,"ion-button",2),c.dc("click",(function(){return e.onDismiss()})),c.Qb(5,"ion-icon",3),c.Ub(),c.Ub(),c.Ub(),c.Ub(),c.Vb(6,"ion-content",4),c.Dc(7,S,16,12,"div",5),c.Dc(8,D,30,20,"div",6),c.Dc(9,W,39,28,"div",6),c.Ub()),2&n&&(c.Cb(7),c.mc("ngIf",!e.showLoginForm&&!e.showSignUpForm),c.Cb(1),c.mc("ngIf",e.showLoginForm),c.Cb(1),c.mc("ngIf",e.showSignUpForm))},directives:[u.s,u.Y,u.W,u.k,u.j,u.t,u.p,l.l,u.J,u.o,o.n,o.j,o.d,u.x,u.w,u.ib,o.i,o.b,u.P,u.T],pipes:[b.c],styles:[""]}),M)},b8Qw:function(n,e,t){"use strict";t.d(e,"a",(function(){return u}));var i,o,r=t("d2mR"),s=t("3Pt+"),a=t("fXoL"),c=((o=function n(){_classCallCheck(this,n)}).\u0275mod=a.Nb({type:o}),o.\u0275inj=a.Mb({factory:function(n){return new(n||o)},imports:[[r.a,s.e,s.l]]}),o),u=((i=function n(){_classCallCheck(this,n)}).\u0275mod=a.Nb({type:i}),i.\u0275inj=a.Mb({factory:function(n){return new(n||i)},imports:[[r.a,s.e,s.l,c]]}),i)},gNTI:function(n,e,t){"use strict";t.d(e,"a",(function(){return r}));var i=t("v0iw"),o=t("fXoL"),r=function(){var n=function(n){_inherits(t,n);var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.call(this,"AppConfig")}return _createClass(t,[{key:"load",value:function(){return i.Cloud.run("getAppConfig")}},{key:"about",get:function(){return this.get("about")}},{key:"admin",get:function(){return this.get("admin")}},{key:"layout",get:function(){return this.get("layout")}},{key:"auth",get:function(){return this.get("auth")}}]),t}(i.Object);return n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=o.Lb({token:n,factory:n.\u0275fac,providedIn:"root"}),n}();i.Object.registerSubclass("AppConfig",r)}}]);